import javafx.geometry.Insets;
import javafx.geometry.Pos;
import javafx.geometry.Rectangle2D;
import javafx.scene.control.Button;
import java.io.File;
import java.net.MalformedURLException;

import javafx.scene.control.Label;
import javafx.scene.control.ScrollPane;
import javafx.scene.control.Tab;
import javafx.scene.image.Image;
import javafx.scene.image.ImageView;
import javafx.scene.layout.Border;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.BorderStroke;
import javafx.scene.layout.BorderStrokeStyle;
import javafx.scene.layout.BorderWidths;
import javafx.scene.layout.CornerRadii;
import javafx.scene.layout.HBox;
import javafx.scene.layout.Pane;
import javafx.scene.layout.Priority;
import javafx.scene.layout.StackPane;
import javafx.scene.layout.VBox;
import javafx.scene.paint.Color;
import javafx.scene.paint.Paint;
import javafx.scene.shape.Rectangle;
import javafx.scene.text.Font;
import javafx.scene.text.FontPosture;

public class RecipeTab extends Tab
{
	private String workingDirectory;
	private String higherWorkingDirectory;
	
	public RecipeTab(String higherWorkingDirectory) throws MalformedURLException
	{
		this.higherWorkingDirectory = higherWorkingDirectory;
		workingDirectory = higherWorkingDirectory + "\\Recipes";
		
		setStandardView();
		System.out.println("new working directory is " + workingDirectory);
		File testDirectory = new File(workingDirectory);
		if(!testDirectory.exists()) 
			if(!testDirectory.mkdirs())System.out.println("Failed to make directory " + workingDirectory);
		
		this.setText("Recipes");
		this.setClosable(false);
	}
	private void setEditRecipeView()
	{
		
	}
	public void setStandardView() throws MalformedURLException
	{
			BorderPane recipeLayoutPane = new BorderPane();
				Pane addRecipePane = new Pane();
				addRecipePane.setBorder(new Border(new BorderStroke(Color.BLACK, BorderStrokeStyle.SOLID, CornerRadii.EMPTY, new BorderWidths(2,0,0,0))));
					Button addRecipe = new Button("Add Recipe");
					addRecipe.setLayoutX(3);
					addRecipe.setStyle("-fx-background-radius: 0");
					addRecipe.setLayoutY(5);
					Button refreshRecipeList = new Button("Refresh");
					refreshRecipeList.setStyle("-fx-background-radius: 0");
					refreshRecipeList.setLayoutX(85);
					refreshRecipeList.setLayoutY(5);
						ScrollPane recipeScrollPane = new ScrollPane();
							VBox recipeList = new VBox();
							recipeList.prefWidthProperty().bind(recipeScrollPane.widthProperty());
							recipeList.setPadding(new Insets(0,15,0,0));
							refreshRecipeList(recipeList);
						recipeScrollPane.setContent(recipeList);
				addRecipePane.getChildren().addAll(addRecipe,refreshRecipeList);
			recipeLayoutPane.setTop(addRecipePane);
			recipeLayoutPane.setCenter(recipeScrollPane);
		this.setContent(recipeLayoutPane);
	}
	private void refreshRecipeList(VBox recipeListRefresh) throws MalformedURLException
	{
		File recipeDirectory = new File(workingDirectory);
		for (File sub : recipeDirectory.listFiles())
        {
	            HBox recipeBox = new HBox();
	        		String recipeName = sub.getName();
	            	Label recipeLabel = new Label(recipeName);
	            	recipeLabel.setFont(Font.font("Arial", FontPosture.REGULAR, 20));
	            		HBox recipeOptions = new HBox();
	            		System.out.println(higherWorkingDirectory + "\\extra\\edit.jpg");
	            			File editButton = new File(higherWorkingDirectory + "\\extra\\edit.jpg");
	            			Image editButtonJPG = new Image(editButton.toURI().toURL().toExternalForm());
	            			ImageView editButtonImageView = new ImageView(editButtonJPG);
	            			//editButtonImageView.setViewport(new Rectangle2D(626,626,626,626));
	            			//editButtonImageView.setFitWidth(100);
	            	        //editButtonImageView.setPreserveRatio(true);
	            			Button editRecipeBt = new Button("",editButtonImageView);
	            			editRecipeBt.setStyle("-fx-background-radius: 0");
	            			Button deleteRecipeBt = new Button("X");
	            			deleteRecipeBt.setStyle("-fx-background-radius: 0;-fx-text-fill: Red");
	            		recipeOptions.setAlignment(Pos.CENTER_RIGHT);
	            		recipeOptions.getChildren().add(editRecipeBt);
	            		recipeOptions.getChildren().add(deleteRecipeBt);
	            recipeBox.getChildren().add(recipeLabel);
	            recipeBox.getChildren().add(recipeOptions);
	            HBox.setHgrow(recipeOptions, Priority.ALWAYS);
	            recipeBox.setPadding(new Insets(1,1,1,1));
	            recipeBox.prefWidthProperty().bind(recipeListRefresh.widthProperty());
	            recipeBox.setBorder(new Border(new BorderStroke(Color.BLACK, BorderStrokeStyle.SOLID, CornerRadii.EMPTY, new BorderWidths(2,2,2,2))));
	        recipeListRefresh.getChildren().add(recipeBox);
        }
	}
	
}
